<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Variable Selection in Functional Data Classification — classif.gsam.vs • fda.usc</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Variable Selection in Functional Data Classification — classif.gsam.vs"><meta property="og:description" content="Computes classification by selecting the functional (and non functional)
explanatory variables."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fda.usc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/moviedo5/fda.usc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Variable Selection in Functional Data Classification</h1>
    <small class="dont-index">Source: <a href="https://github.com/moviedo5/fda.usc/blob/HEAD/R/classif.gsam.vs.R" class="external-link"><code>R/classif.gsam.vs.R</code></a></small>
    <div class="hidden name"><code>classif.gsam.vs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes classification by selecting the functional (and non functional)
explanatory variables.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">classif.gsam.vs</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="st">"equal"</span>,</span>
<span>  basis.x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  basis.b <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"1vsall"</span>,</span>
<span>  prob <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  dcor.min <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  smooth <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  measure <span class="op">=</span> <span class="st">"accuracy"</span>,</span>
<span>  <span class="va">xydist</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>List that containing the variables in the model.  "df" element
is a  <code>data.frame</code> with the response and scalar covariates (numeric and factors
variables are allowed). Functional covariates of class <code>fdata</code> or
<code>fd</code> are introduced in the following items in the <code>data</code> list.</p></dd>


<dt>y</dt>
<dd><p><code>caracter</code> string with the name of the scalar response variable</p></dd>


<dt>x</dt>
<dd><p><code>caracter</code> string vector with the name of the scalar and functional
potential covariates.</p></dd>


<dt>family</dt>
<dd><p>a description of the error distribution and link function to
be used in the model. This can be a character string naming a family
function, a family function or the result of a call to a family function.
(See <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code> for details of family functions.)</p></dd>


<dt>weights</dt>
<dd><p>Weights:</p><ul><li><p>if <code>character</code> string <code>='equal'</code> same weights for each observation (by default) and
<code>='inverse'</code> for inverse-probability of weighting.</p></li>
<li><p>if <code>numeric</code> vector of length <code>n</code>, Weight values of each observation.</p></li>
</ul></dd>


<dt>basis.x</dt>
<dd><p>List of basis for functional explanatory data estimation.</p></dd>


<dt>basis.b</dt>
<dd><p>List of basis for functional beta parameter estimation.</p></dd>


<dt>type</dt>
<dd><p><code>character</code>, type of scheme classification. <code>'1vsall'</code>  (by default) 
strategy involves training a single classifier per class, with the samples of that class 
as positive samples and all other samples as negatives. Other posibility for K-way multiclass problem
is the <code>'majority'</code> voting scheme (also called one vs one). 
The procedure  trains the \(K (K - 1) / 2\)  binary classifiers and predicts the final class label as the class
label that has been predicted most frequently.</p></dd>


<dt>prob</dt>
<dd><p>probability value used for binary discriminant.</p></dd>


<dt>alpha</dt>
<dd><p>alpha value to test the null hypothesis for the test of
independence among covariate X and residual e. By default is <code>0.05</code>.</p></dd>


<dt>dcor.min</dt>
<dd><p>lower threshold for the variable X to be considered. X is
discarded if the distance correlation \(R(X,e)&lt; dcor.min\) (e is the
residual).</p></dd>


<dt>smooth</dt>
<dd><p>if <code>TRUE</code>, a smooth estimate is made for all covariates included
in the model (less for factors). The model is adjusted with the estimated
variable linearly or smoothly. If the models are equivalent, the model is
adjusted with the linearly estimated variable.</p></dd>


<dt>measure</dt>
<dd><p>measure related with correct classification (by default accuracy).</p></dd>


<dt>xydist</dt>
<dd><p>list with the matrices of distances of each variable (all
potential covariates and the response) with itself.</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to or from other methods.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Return the final fitted model (same result of the classsification method) plus:<br></p>


<ul><li><p><code>dcor</code>, <code>matrix</code> with the values of distance correlation for each
pontential covariate  (by column) and the residual of the model in each step (by row).</p></li>
<li><p><code>i.predictor</code>, <code>vector</code> with 1 if the variable is selected, 0 otherwise.</p></li>
<li><p><code>ipredictor</code>, <code>vector</code> with the name of selected variables (in order of selection)</p></li>
</ul></div>
    <div id="note">
    <h2>Note</h2>
    <p>Adapted version from the original method in repression: <code><a href="fregre.gsam.vs.html">fregre.gsam.vs</a></code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Febrero-Bande, M., Gonz\'alez-Manteiga, W. and Oviedo de la
Fuente, M. Variable selection in functional additive regression models,
(2018).  Computational Statistics, 1-19. DOI:
<a href="https://doi.org/10.1007/s00180-018-0844-5" class="external-link">doi:10.1007/s00180-018-0844-5</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>See Also as:  <code><a href="classif.gsam.html">classif.gsam</a></code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Febrero-Bande, M. and Oviedo de la Fuente, M.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">tecator</span><span class="op">$</span><span class="va">absorp.fdata</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="fdata.deriv.html">fdata.deriv</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="fdata.deriv.html">fdata.deriv</a></span><span class="op">(</span><span class="va">x</span>,nderiv<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">$</span><span class="va">y</span><span class="op">$</span><span class="va">Fat</span><span class="op">&lt;</span><span class="fl">12</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xcat0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xcat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">$</span><span class="va">y</span><span class="op">$</span><span class="va">Protein</span>,<span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xcat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">$</span><span class="va">y</span><span class="op">$</span><span class="va">Water</span>,<span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">129</span></span></span>
<span class="r-in"><span><span class="va">dat</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Fat"</span><span class="op">=</span><span class="va">y</span>, <span class="va">x1</span><span class="op">$</span><span class="va">data</span>, <span class="va">xcat1</span>, <span class="va">xcat2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ldat</span> <span class="op">&lt;-</span> <span class="fu"><a href="ldata.html">ldata</a></span><span class="op">(</span><span class="st">"df"</span><span class="op">=</span><span class="va">dat</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span>,<span class="st">"x"</span><span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span>,<span class="st">"x1"</span><span class="op">=</span><span class="va">x1</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span>,<span class="st">"x2"</span><span class="op">=</span><span class="va">x2</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># 3 functionals (x,x1,x2), 3 factors (xcat0, xcat1, xcat2)</span></span></span>
<span class="r-in"><span><span class="co"># and 100 scalars (impact poitns of x1) </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res.gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="classif.gsam.html">classif.gsam</a></span><span class="op">(</span><span class="va">Fat</span><span class="op">~</span><span class="fu">s</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,data<span class="op">=</span><span class="va">ldat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.gam</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Time consuming</span></span></span>
<span class="r-in"><span><span class="va">res.gam.vs</span> <span class="op">&lt;-</span> <span class="fu">classif.gsam.vs</span><span class="op">(</span><span class="st">"Fat"</span>,data<span class="op">=</span><span class="va">ldat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.gam.vs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res.gam.vs</span><span class="op">$</span><span class="va">i.predictor</span></span></span>
<span class="r-in"><span><span class="va">res.gam.vs</span><span class="op">$</span><span class="va">ipredictor</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Prediction </span></span></span>
<span class="r-in"><span><span class="va">newldat</span> <span class="op">&lt;-</span> <span class="fu"><a href="ldata.html">ldata</a></span><span class="op">(</span><span class="st">"df"</span><span class="op">=</span><span class="va">dat</span><span class="op">[</span><span class="op">-</span><span class="va">ind</span>,<span class="op">]</span>,<span class="st">"x"</span><span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="va">ind</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>                <span class="st">"x1"</span><span class="op">=</span><span class="va">x1</span><span class="op">[</span><span class="op">-</span><span class="va">ind</span>,<span class="op">]</span>,<span class="st">"x2"</span><span class="op">=</span><span class="va">x2</span><span class="op">[</span><span class="op">-</span><span class="va">ind</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred.gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res.gam</span>,<span class="va">newldat</span><span class="op">)</span>                </span></span>
<span class="r-in"><span><span class="va">pred.gam.vs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res.gam.vs</span>,<span class="va">newldat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="accuracy.html">cat2meas</a></span><span class="op">(</span><span class="va">newldat</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">Fat</span>, <span class="va">pred.gam</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="accuracy.html">cat2meas</a></span><span class="op">(</span><span class="va">newldat</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">Fat</span>, <span class="va">pred.gam.vs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Manuel Febrero Bande, Manuel Oviedo de la Fuente.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

