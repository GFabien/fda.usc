<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Functional Regression with scalar response using basis representation. — fregre.basis • fda.usc</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Functional Regression with scalar response using basis representation. — fregre.basis"><meta property="og:description" content="Computes functional regression between functional explanatory variable
\(X(t)\) and scalar response \(Y\) using basis representation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fda.usc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/moviedo5/fda.usc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Functional Regression with scalar response using basis representation.</h1>
    <small class="dont-index">Source: <a href="https://github.com/moviedo5/fda.usc/blob/HEAD/R/fregre.basis.R" class="external-link"><code>R/fregre.basis.R</code></a></small>
    <div class="hidden name"><code>fregre.basis.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes functional regression between functional explanatory variable
\(X(t)\) and scalar response \(Y\) using basis representation.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fregre.basis</span><span class="op">(</span></span>
<span>  <span class="va">fdataobj</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  basis.x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  basis.b <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  Lfdobj <span class="op">=</span> <span class="fu">vec2Lfd</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="va">rtt</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>fdataobj</dt>
<dd><p><code><a href="fdata.html">fdata</a></code> class object.</p></dd>


<dt>y</dt>
<dd><p>Scalar response with length <code>n</code>.</p></dd>


<dt>basis.x</dt>
<dd><p>Basis for functional explanatory data <code>fdataobj</code>.</p></dd>


<dt>basis.b</dt>
<dd><p>Basis for functional beta parameter.</p></dd>


<dt>lambda</dt>
<dd><p>A roughness penalty. By default, no penalty <code>lambda=0</code>.</p></dd>


<dt>Lfdobj</dt>
<dd><p>See <a href="https://rdrr.io/pkg/fda/man/eval.penalty.html" class="external-link">eval.penalty</a>.</p></dd>


<dt>weights</dt>
<dd><p>weights</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to or from other methods.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Return:</p><ul><li><p>call: The matched call.</p></li>
<li><p>coefficients: A named vector of coefficients</p></li>
<li><p>residuals: <code>y</code> minus <code>fitted values</code>.</p></li>
<li><p>fitted.values: Estimated scalar response.</p></li>
<li><p>beta.est: beta parameter estimated of class <code>fd</code></p></li>
<li><p>weights:(only for' weighted fits) the specified weights.</p></li>
<li><p>df.residual: The residual degrees of' freedom.</p></li>
<li><p>r2: Coefficient of determination.</p></li>
<li><p>sr2: Residual' variance.</p></li>
<li><p>Vp: Estimated covariance matrix for the parameters.</p></li>
<li><p>H: Hat matrix.</p></li>
<li><p>y: Response.</p></li>
<li><p>fdataobj: Functional explanatory data of class <code>fdata</code>.</p></li>
<li><p>a.est: Intercept parameter estimated</p></li>
<li><p>basis.b: Basis used' for beta parameter estimation.</p></li>
<li><p>lambda.opt: A roughness penalty.</p></li>
<li><p>Lfdobj: Order of a derivative or a linear differential operator.</p></li>
<li><p>P: Penalty matrix.</p></li>
<li><p>lm: Return <code>lm</code> object</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>$$Y=\big&lt;X,\beta\big&gt;+\epsilon=\int_{T}{X(t)\beta(t)dt+\epsilon}$$ 
where \( \big&lt; \cdot , \cdot \big&gt;\) denotes the inner product on
\(L_2\) and \(\epsilon\) are random errors with mean zero, finite
variance \(\sigma^2\) and \(E[X(t)\epsilon]=0\).</p>
<p>The function uses the basis representation proposed by Ramsay and Silverman (2005) to model the
relationship between the scalar response and the functional covariate by
basis representation of the observed functional data
\(X(t)\approx\sum_{k=1}^{k_{n1}} c_k \xi_k(t)\) and the unknown
functional parameter \(\beta(t)\approx\sum_{k=1}^{k_{n2}} b_k
\phi_k(t)\). <br></p>
<p>The functional linear models estimated by the expression: $$\hat{y}=
\big&lt; X,\hat{\beta} \big&gt; =
C^{T}\psi(t)\phi^{T}(t)\hat{b}=\tilde{X}\hat{b}$$ where
\(\tilde{X}(t)=C^{T}\psi(t)\phi^{T}(t)\), and
\(\hat{b}=(\tilde{X}^{T}\tilde{X})^{-1}\tilde{X}^{T}y\)
and so,
\(\hat{y}=\tilde{X}\hat{b}=\tilde{X}(\tilde{X}^{T}\tilde{X})^{-1}\tilde{X}^{T}y=Hy\)
where \(H\) is the hat matrix with degrees of freedom: \(df=tr(H)\).<br></p>
<p>If \(\lambda&gt;0\) then <code>fregre.basis</code> incorporates a
roughness penalty: <br>
\(\hat{y}=\tilde{X}\hat{b}=\tilde{X}(\tilde{X}^{T}\tilde{X}+\lambda
R_0)^{-1}\tilde{X}^{T}y= H_{\lambda}y\) where \(R_0\) is the penalty matrix.<br></p>
<p>This function allows covariates of class <code>fdata</code>, <code>matrix</code>,
<code>data.frame</code> or directly covariates of class <code>fd</code>.  The function
also gives default values to arguments <code>basis.x</code> and <code>basis.b</code> for
representation on the basis of functional data \(X(t)\) and the functional
parameter \(\beta(t)\), respectively.</p>
<p>If <code>basis=</code><code>NULL</code> creates the <code>bspline</code> basis by
<code>create.bspline.basis</code>. <br> If the functional covariate
<code>fdataobj</code> is a matrix or data.frame, it creates an object of class
"fdata" with default attributes, see <code><a href="fdata.html">fdata</a></code>.<br> If
<code>basis.x$type=``fourier''</code> and <code>basis.b$type=``fourier''</code>, the
basis are orthonormal and the function decreases the number of fourier basis
elements on the \(min(k_{n1},k_{n2})\), where
\(k_{n1}\) and \(k_{n2}\) are the number of basis element of
<code>basis.x</code> and <code>basis.b</code> respectively.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Ramsay, James O., and Silverman, Bernard W. (2006), <em>
Functional Data Analysis</em>, 2nd ed., Springer, New York.</p>
<p>Febrero-Bande, M., Oviedo de la Fuente, M. (2012).  <em>Statistical
Computing in Functional Data Analysis: The R Package fda.usc.</em> Journal of
Statistical Software, 51(4), 1-28. <a href="https://www.jstatsoft.org/v51/i04/" class="external-link">https://www.jstatsoft.org/v51/i04/</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>See Also as: <code><a href="fregre.basis.cv.html">fregre.basis.cv</a></code>,
<code><a href="summary.fregre.fd.html">summary.fregre.fd</a></code> and <code><a href="predict.fregre.fd.html">predict.fregre.fd</a></code>.<br>
Alternative method: <code><a href="fregre.pc.html">fregre.pc</a></code> and <code><a href="fregre.np.html">fregre.np</a></code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Manuel Febrero-Bande, Manuel Oviedo de la Fuente
<a href="mailto:manuel.oviedo@udc.es">manuel.oviedo@udc.es</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># fregre.basis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">absorp</span><span class="op">=</span><span class="va">tecator</span><span class="op">$</span><span class="va">absorp.fdata</span></span></span>
<span class="r-in"><span><span class="va">ind</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">129</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">=</span><span class="va">absorp</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">=</span><span class="va">tecator</span><span class="op">$</span><span class="va">y</span><span class="op">$</span><span class="va">Fat</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">tt</span><span class="op">=</span><span class="va">absorp</span><span class="op">[[</span><span class="st">"argvals"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">res1</span><span class="op">=</span><span class="fu">fregre.basis</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">basis1</span><span class="op">=</span><span class="fu">create.bspline.basis</span><span class="op">(</span>rangeval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span>,nbasis<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">basis2</span><span class="op">=</span><span class="fu">create.bspline.basis</span><span class="op">(</span>rangeval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span>,nbasis<span class="op">=</span><span class="fl">9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res5</span><span class="op">=</span><span class="fu">fregre.basis</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">basis1</span>,<span class="va">basis2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x.d2</span><span class="op">=</span><span class="fu"><a href="fdata.deriv.html">fdata.deriv</a></span><span class="op">(</span><span class="va">x</span>,nbasis<span class="op">=</span><span class="fl">19</span>,nderiv<span class="op">=</span><span class="fl">1</span>,method<span class="op">=</span><span class="st">"bspline"</span>,class.out<span class="op">=</span><span class="st">"fdata"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res7</span><span class="op">=</span><span class="fu">fregre.basis</span><span class="op">(</span><span class="va">x.d2</span>,<span class="va">y</span>,<span class="va">basis1</span>,<span class="va">basis2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Manuel Febrero Bande, Manuel Oviedo de la Fuente.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

