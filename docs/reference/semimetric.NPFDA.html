<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Proximities between functional data (semi-metrics) — semimetric.NPFDA • fda.usc</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Proximities between functional data (semi-metrics) — semimetric.NPFDA"><meta property="og:description" content="Computes semi-metric distances of functional data based on Ferraty F and
Vieu, P. (2006)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fda.usc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/moviedo5/fda.usc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Proximities between functional data (semi-metrics)</h1>
    <small class="dont-index">Source: <a href="https://github.com/moviedo5/fda.usc/blob/HEAD/R/semimetric.NPFDA.r" class="external-link"><code>R/semimetric.NPFDA.r</code></a></small>
    <div class="hidden name"><code>semimetric.NPFDA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes semi-metric distances of functional data based on Ferraty F and
Vieu, P. (2006).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">semimetric.deriv</span><span class="op">(</span></span>
<span>  <span class="va">fdata1</span>,</span>
<span>  fdata2 <span class="op">=</span> <span class="va">fdata1</span>,</span>
<span>  nderiv <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nknot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span> <span class="op">-</span> <span class="va">nderiv</span> <span class="op">-</span> <span class="fl">4</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span> <span class="op">-</span> <span class="va">nderiv</span> <span class="op">-</span> <span class="fl">4</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">semimetric.fourier</span><span class="op">(</span></span>
<span>  <span class="va">fdata1</span>,</span>
<span>  fdata2 <span class="op">=</span> <span class="va">fdata1</span>,</span>
<span>  nderiv <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  nbasis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span> <span class="op">-</span> <span class="va">nderiv</span> <span class="op">-</span> <span class="fl">4</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span> <span class="op">-</span> <span class="va">nderiv</span> <span class="op">-</span> <span class="fl">4</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  period <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">semimetric.hshift</span><span class="op">(</span><span class="va">fdata1</span>, fdata2 <span class="op">=</span> <span class="va">fdata1</span>, t <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">DATA1</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">semimetric.mplsr</span><span class="op">(</span><span class="va">fdata1</span>, fdata2 <span class="op">=</span> <span class="va">fdata1</span>, q <span class="op">=</span> <span class="fl">2</span>, <span class="va">class1</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">semimetric.pca</span><span class="op">(</span><span class="va">fdata1</span>, fdata2 <span class="op">=</span> <span class="va">fdata1</span>, q <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="source">
    <h2>Source</h2>
    <p><a href="https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NPFDA/" class="external-link">https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NPFDA/</a></p>
    </div>
    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>fdata1</dt>
<dd><p>Functional data 1 or curve 1. <code>DATA1</code> with dimension
(<code>n1</code> x <code>m</code>), where <code>n1</code> is the number of curves and <code>m</code>
are the points observed in each curve.</p></dd>


<dt>fdata2</dt>
<dd><p>Functional data 2 or curve 2. <code>DATA1</code> with dimension
(<code>n2</code> x <code>m</code>), where <code>n2</code> is the number of curves and <code>m</code>
are the points observed in each curve.</p></dd>


<dt>nderiv</dt>
<dd><p>Order of derivation, used in <code>semimetric.deriv</code> and <br><code>semimetric.fourier</code></p></dd>


<dt>nknot</dt>
<dd><p>semimetric.deriv argument: number of interior knots (needed for
defining the B-spline basis).</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to or from other methods.</p></dd>


<dt>nbasis</dt>
<dd><p><code>semimetric.fourier</code>: size of the basis.</p></dd>


<dt>period</dt>
<dd><p><code>semimetric.fourier</code>:allows to select the period for the
fourier expansion.</p></dd>


<dt>t</dt>
<dd><p><code>semimetric.hshift</code>: vector which defines <code>t</code> (one can
choose <code>1,2,...,nbt</code> where <code>nbt</code> is the number of points of the
discretization)</p></dd>


<dt>q</dt>
<dd><p>If <code>semimetric.pca</code>: the retained number of principal
components.<br> If <code>semimetric.mplsr</code>: the retained number of factors.</p></dd>


<dt>class1</dt>
<dd><p><code>semimetric.mplsr</code>: vector containing a categorical
response which corresponds to class number for units stored in <code>DATA1</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns a proximities matrix between two functional datasets.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>semimetric.deriv</code>: approximates \(L_2\) metric
between derivatives of the curves based on ther B-spline representation. The
derivatives set with the argument <code>nderiv</code>.<br><code>semimetric.fourier</code>: approximates \(L_2\) metric between the curves
based on ther B-spline representation. The derivatives set with the argument
<code>nderiv</code>.<br><code>semimetric.hshift</code>: computes distance between curves
taking into account an horizontal shift effect.<br><code>semimetric.mplsr</code>:
computes distance between curves based on the partial least squares
method.<br><code>semimetric.pca</code>: computes distance between curves based on
the functional principal components analysis method.</p>
<p>In the next semi-metric functions the functional data \(X\) is
approximated by \(k_n\) elements of the Fourier, B--spline, PC or PLS basis
using, \(\hat{X_i} =\sum_{k=1}^{k_n}\nu_{k,i}\xi_k\), where \(\nu_k\)
are the coefficient of the expansion on the basis function
\(\left\{\xi_k\right\}_{k=1}^{\infty}\).<br> The distances between the q-order derivatives of two curves \(X_{1}\) and
\(X_2\) is,
$$d_{2}^{(q)}\left(X_1,X_2\right)_{k_n}=\sqrt{\frac{1}{T}\int_{T}\left(X_{1}^{(q)}(t)-X_{2}^{(q)}(t)\right)^2
dt}$$ where \(X_{i}^{(q)}\left(t\right)\) denot the \(q\) derivative of
\(X_i\).</p>
<p><code>semimetric.deriv</code> and <code>semimetric.fourier</code> function use a
B-spline and Fourier approximation respectively for each curve and the
derivatives are directly computed by differentiating several times their
analytic form, by default <code>q=1</code> and <code>q=0</code> respectively.
<code>semimetric.pca</code> and <code>semimetric.mprls</code> function compute
proximities between curves based on the functional principal components
analysis (FPCA) and the functional partial least square analysis (FPLS),
respectively. The FPC and FPLS reduce the functional data in a reduced
dimensional space (q components). <code>semimetric.mprls</code> function requires
a scalar response.</p>
<p>$$d_{2}^{(q)}\left(X_1,X_2\right)_{k_n}\approx\sqrt{\sum_{k=1}^{k_n}\left(\nu_{k,1}-\nu_{k,2}\right)^2\left\|\xi_k^{(q)}\right\|dt}$$
<code>semimetric.hshift</code> computes proximities between curves taking into
account an horizontal shift effect.</p>
<p>$$d_{hshift}\left(X_1,X_2\right)=\min_{h\in\left[-mh,mh\right]}d_2(X_1(t),X_2(t+h))$$
where \(mh\) is the maximum horizontal shifted allowed.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Ferraty, F. and Vieu, P. (2006). <em>Nonparametric functional
data analysis.</em> Springer Series in Statistics, New York.</p>
<p>Ferraty, F. and Vieu, P. (2006). <em>NPFDA in practice</em>.  Free access on
line at <a href="https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NPFDA/" class="external-link">https://www.math.univ-toulouse.fr/~ferraty/SOFTWARES/NPFDA/</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>See also <code><a href="metric.lp.html">metric.lp</a></code> and <code><a href="semimetric.basis.html">semimetric.basis</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> </span></span>
<span class="r-in"><span><span class="co">#  INFERENCE PHONDAT</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">phoneme</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ind</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span> <span class="co"># 2 groups</span></span></span>
<span class="r-in"><span><span class="va">mlearn</span><span class="op">&lt;-</span><span class="va">phoneme</span><span class="op">$</span><span class="va">learn</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mtest</span><span class="op">&lt;-</span><span class="va">phoneme</span><span class="op">$</span><span class="va">test</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mlearn</span><span class="op">[[</span><span class="st">"data"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">np</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mlearn</span><span class="op">[[</span><span class="st">"data"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mdist1</span><span class="op">=</span><span class="fu">semimetric.pca</span><span class="op">(</span><span class="va">mlearn</span>,<span class="va">mtest</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mdist2</span><span class="op">=</span><span class="fu">semimetric.pca</span><span class="op">(</span><span class="va">mlearn</span>,<span class="va">mtest</span>,q<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mdist3</span><span class="op">=</span><span class="fu">semimetric.deriv</span><span class="op">(</span><span class="va">mlearn</span>,<span class="va">mtest</span>,nderiv<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mdist4</span><span class="op">=</span><span class="fu">semimetric.fourier</span><span class="op">(</span><span class="va">mlearn</span>,<span class="va">mtest</span>,nderiv<span class="op">=</span><span class="fl">2</span>,nbasis<span class="op">=</span><span class="fl">21</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#uses hshift function</span></span></span>
<span class="r-in"><span><span class="co">#mdist5=semimetric.hshift(mlearn,mtest) #takes a lot</span></span></span>
<span class="r-in"><span><span class="va">glearn</span><span class="op">&lt;-</span><span class="va">phoneme</span><span class="op">$</span><span class="va">classlearn</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co">#uses mplsr function</span></span></span>
<span class="r-in"><span><span class="va">mdist6</span><span class="op">=</span><span class="fu">semimetric.mplsr</span><span class="op">(</span><span class="va">mlearn</span>,<span class="va">mtest</span>,<span class="fl">5</span>,<span class="va">glearn</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mdist0</span><span class="op">=</span><span class="fu"><a href="metric.lp.html">metric.lp</a></span><span class="op">(</span><span class="va">mlearn</span>,<span class="va">mtest</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">b</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">mdist6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">c2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">c2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">memb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">c2</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">memb</span>,<span class="va">phoneme</span><span class="op">$</span><span class="va">classlearn</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span> </span></span>
<span class="r-in"><span>  </span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Manuel Febrero Bande, Manuel Oviedo de la Fuente.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

