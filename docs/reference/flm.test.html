<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Goodness-of-fit test for the Functional Linear Model with scalar response — flm.test • fda.usc</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Goodness-of-fit test for the Functional Linear Model with scalar response — flm.test"><meta property="og:description" content="The function flm.test tests the composite null hypothesis of
a Functional Linear Model with scalar response (FLM),
$$H_0:\,Y=\big&amp;lt;X,\beta\big&amp;gt;+\epsilon,$$  versus
a general alternative. If \(\beta=\beta_0\) is provided, then the 
simple hypothesis \(H_0:\,Y=\big&amp;lt;X,\beta_0\big&amp;gt;+\epsilon\) is tested.
The testing of the null hypothesis is done by a Projected Cramer-von Mises statistic (see Details)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fda.usc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/moviedo5/fda.usc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Goodness-of-fit test for the Functional Linear Model with scalar response</h1>
    <small class="dont-index">Source: <a href="https://github.com/moviedo5/fda.usc/blob/HEAD/R/flm.test.R" class="external-link"><code>R/flm.test.R</code></a></small>
    <div class="hidden name"><code>flm.test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function <code>flm.test</code> tests the composite null hypothesis of
a Functional Linear Model with scalar response (FLM),
$$H_0:\,Y=\big&lt;X,\beta\big&gt;+\epsilon,$$  versus
a general alternative. If \(\beta=\beta_0\) is provided, then the 
simple hypothesis \(H_0:\,Y=\big&lt;X,\beta_0\big&gt;+\epsilon\) is tested.
The testing of the null hypothesis is done by a Projected Cramer-von Mises statistic (see Details).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">flm.test</span><span class="op">(</span></span>
<span>  <span class="va">X.fdata</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  beta0.fdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  est.method <span class="op">=</span> <span class="st">"pls"</span>,</span>
<span>  p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type.basis <span class="op">=</span> <span class="st">"bspline"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot.it <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  B.plot <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  G <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>X.fdata</dt>
<dd><p>Functional covariate for the FLM. The object must be in the class 
<code><a href="fdata.html">fdata</a></code>.</p></dd>


<dt>Y</dt>
<dd><p>Scalar response for the FLM. Must be a vector with the same number of elements
as functions are in <code>X.fdata</code>.</p></dd>


<dt>beta0.fdata</dt>
<dd><p>Functional parameter for the simple null hypothesis, in the <code><a href="fdata.html">fdata</a></code> class. 
Recall that the <code>argvals</code> and <code>rangeval</code> arguments of <code>beta0.fdata</code> must be the same
of <code>X.fdata</code>. A possibility to do this is to consider, for example for \(\beta_0=0\) 
(the simple null hypothesis of no interaction),
 <code>beta0.fdata=fdata(mdata=rep(0,length(X.fdata$argvals)),</code><code>argvals=X.fdata$argvals,rangeval=X.fdata$rangeval)</code>.
 If <code>beta0.fdata=NULL</code> (default), the function will test for the composite null hypothesis.</p></dd>


<dt>B</dt>
<dd><p>Number of bootstrap replicates to calibrate the distribution of the test statistic.
<code>B=5000</code> replicates are the recommended for carry out the test, although for exploratory analysis
 (<b>not inferential</b>), an acceptable less time-consuming option is <code>B=500</code>.</p></dd>


<dt>est.method</dt>
<dd><p>Estimation method for the unknown parameter \(\beta\), 
only used in the composite case. Mainly, there are two options: specify the number of basis 
elements for the estimated \(\beta\) by <code>p</code> or optimally select <code>p</code> by a
 data-driven criteria (see Details section for discussion). Then, it must be one of the following 
 methods:</p><ul><li><p><code>"pc"</code> If <code>p</code>, the number of basis elements, is given, then \(\beta\) is estimated by <code><a href="fregre.pc.html">fregre.pc</a></code>. Otherwise, an optimum <code>p</code> is chosen using <code><a href="fregre.pc.cv.html">fregre.pc.cv</a></code> and the <code>"SICc"</code> criteria.</p></li>
<li><p><code>"pls"</code> If <code>p</code> is given, \(\beta\) is estimated by <code><a href="fregre.pls.html">fregre.pls</a></code>. Otherwise, an optimum <code>p</code> is chosen using <code><a href="fregre.pls.cv.html">fregre.pls.cv</a></code> and the <code>"SICc"</code> criteria. 
 This is the default argument as it has been checked empirically that provides a good balance between the performance of the test and the estimation of \(\beta\).</p></li>
<li><p><code>"basis"</code> If <code>p</code> is given, \(\beta\) is estimated by <code><a href="fregre.basis.html">fregre.basis</a></code>. Otherwise, an optimum <code>p</code> is chosen using <code><a href="fregre.basis.cv.html">fregre.basis.cv</a></code> and the <code>"GCV.S"</code> criteria. In these functions, the same basis for the arguments <code>basis.x</code> and <code>basis.b</code> is considered.
 The type of basis used will be the given by the argument <code>type.basis</code> and must be one of the class of <code>create.basis</code>. Further arguments passed to <code>create.basis</code> (not <code>rangeval</code> that is taken as the <code>rangeval</code> of <code>X.fdata</code>), can be passed throughout <code>...</code> .</p></li>
</ul></dd>


<dt>p</dt>
<dd><p>Number of elements of the basis considered. If it is not given, an optimal <code>p</code> will be chosen using a specific criteria (see <code>est.method</code> and <code>type.basis</code> arguments).</p></dd>


<dt>type.basis</dt>
<dd><p>Type of basis used to represent the functional process. Depending on the hypothesis it will have a different interpretation:
</p><ul><li><p>Simple hypothesis. One of these options:</p><ul><li><p><code>"bspline"</code> If <code>p</code> is given, the functional process is expressed in a basis of <code>p</code> B-splines. If not, an optimal <code>p</code> will be chosen by <code><a href="optim.basis.html">optim.basis</a></code>, using the <code>"GCV.S"</code> criteria.</p></li>
<li><p><code>"fourier"</code> If <code>p</code> is given, the functional process is expressed in a basis of <code>p</code> fourier functions. If not, an optimal <code>p</code> will be chosen by <code><a href="optim.basis.html">optim.basis</a></code>, using the <code>"GCV.S"</code> criteria.</p></li>
<li><p><code>"pc"</code> <code>p</code> must be given. Expresses the functional process in a basis of <code>p</code> PC.</p></li>
<li><p><code>"pls"</code> <code>p</code> must be given. Expresses the functional process in a basis of <code>p</code> PLS.</p></li>
</ul><p>Although other of the basis supported by <code>create.basis</code> are possible too, <code>"bspline"</code> and <code>"fourier"</code> are recommended. Other basis may cause incompatibilities.</p></li>
<li><p>Composite hypothesis. This argument is only used when <code>est.method="basis"</code> and, in this case, claims for the type of basis used in the basis estimation method of the functional parameter. Again, basis
<code>"bspline"</code> and <code>"fourier"</code> are recommended, as other basis may cause incompatibilities.</p></li>
</ul></dd>


<dt>verbose</dt>
<dd><p>Either to show or not information about computing progress.</p></dd>


<dt>plot.it</dt>
<dd><p>Either to show or not a graph of the observed trajectory, 
and the bootstrap trajectories under the null composite hypothesis, of the 
process \(R_n(\cdot)\) (see Details). Note that if <code>plot.it=TRUE</code>, 
the function takes more time to run.</p></dd>


<dt>B.plot</dt>
<dd><p>Number of bootstrap trajectories to show in the resulting plot of the test.
As the trajectories shown are the first <code>B.plot</code> of <code>B</code>, <code>B.plot</code> must be 
lower or equal to <code>B</code>.</p></dd>


<dt>G</dt>
<dd><p>Number of projections used to compute the trajectories of the process
\(R_n(\cdot)\) by Monte Carlo.</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to <code>create.basis</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object with class <code>"htest"</code> whose underlying structure is a list containing 
the following components:</p><ul><li><p>statistic The value of the test statistic.</p></li>
<li><p>boot.statistics A vector of length <code>B</code> with the values of the bootstrap test statistics.</p></li>
<li><p>p.value The p-value of the test.</p></li>
<li><p>method The method used.</p></li>
<li><p>B The number of bootstrap replicates used.</p></li>
<li><p>type.basis The type of basis used.</p></li>
<li><p>beta.est The estimated functional parameter \(\beta\) in the composite 
 hypothesis. For the simple hypothesis, the given <code>beta0.fdata</code>.</p></li>
<li><p>p The number of basis elements passed or automatically chosen.</p></li>
<li><p>ord The optimal order for PC and PLS given by <code><a href="fregre.pc.cv.html">fregre.pc.cv</a></code> and <code><a href="fregre.pls.cv.html">fregre.pls.cv</a></code>. For other methods is setted to <code>1:p</code>.</p></li>
<li><p>data.name The character string "Y=&lt;X,b&gt;+e"</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The Functional Linear Model with scalar response (FLM), is defined as 
\(Y=\big&lt;X,\beta\big&gt;+\epsilon\), for a functional process 
\(X\) such that \(E[X(t)]=0\), \(E[X(t)\epsilon]=0\)
 for all \(t\) and for a scalar variable \(Y\) such that \(E[Y]=0\).
 Then, the test assumes that <code>Y</code> and <code>X.fdata</code> are <b>centred</b> and will automatically 
 center them. So, bear in mind that when you apply the test for <code>Y</code> and <code>X.fdata</code>, 
 actually,  you are applying it to <code>Y-mean(Y)</code> and <code>fdata.cen(X.fdata)$Xcen</code>.
 The test statistic corresponds to the Cramer-von Mises norm of the <em>Residual Marked 
 empirical Process based on Projections</em> \(R_n(u,\gamma)\) defined in 
 Garcia-Portugues <em>et al.</em> (2014). 
 The expression of this process in a \(p\)-truncated basis of the space \(L^2[0,T]\)
 leads to the \(p\)-multivariate process \(R_{n,p}\big(u,\gamma^{(p)}\big)\), 
 whose Cramer-von Mises norm is computed.
 The choice of an appropriate \(p\) to represent the functional process \(X\), 
 in case that is not provided, is done via the estimation of \(\beta\) for the composite 
 hypothesis. For the simple hypothesis, as no estimation of \(\beta\) is done, the choice 
 of \(p\) depends only on the functional process \(X\). As the result of the test may 
 change for different \(p\)'s, we recommend to use an automatic criterion to select \(p\) 
 instead of provide a fixed one.
 The distribution of the test statistic is approximated by a wild bootstrap resampling on the 
 residuals, using the <em>golden section bootstrap</em>.
 Finally, the graph shown if <code>plot.it=TRUE</code> represents the observed trajectory, and the 
 bootstrap trajectories under the null, of the process RMPP <em>integrated on the projections</em>:
 $$R_n(u)\approx\frac{1}{G}\sum_{g=1}^G R_n(u,\gamma_g),$$
  where \(\gamma_g\) are simulated as Gaussians processes. This gives a graphical idea of
   how <em>distant</em> is the observed trajectory from the null hypothesis.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>No NA's are allowed neither in the functional covariate nor in the scalar response.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Escanciano, J. C. (2006). A consistent diagnostic test for regression models using projections. Econometric Theory, 22, 1030-1051. <a href="https://doi.org/10.1017/S0266466606060506" class="external-link">doi:10.1017/S0266466606060506</a></p>
<p>Garcia-Portugues, E., Gonzalez-Manteiga, W. and Febrero-Bande, M. (2014). A goodness--of--fit test for the functional linear model with scalar response. Journal of Computational and Graphical Statistics, 23(3), 761-778. <a href="https://doi.org/10.1080/10618600.2013.812519" class="external-link">doi:10.1080/10618600.2013.812519</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="PCvM.statistic.html">Adot</a></code>, <code><a href="PCvM.statistic.html">PCvM.statistic</a></code>, <code><a href="rwild.html">rwild</a></code>, 
 <code><a href="flm.Ftest.html">flm.Ftest</a></code>, <code><a href="dfv.test.html">dfv.test</a></code>,
 <code><a href="fregre.pc.html">fregre.pc</a></code>, <code><a href="fregre.pls.html">fregre.pls</a></code>, <code><a href="fregre.basis.html">fregre.basis</a></code>, 
 <code><a href="fregre.pc.cv.html">fregre.pc.cv</a></code>, <code><a href="fregre.pls.cv.html">fregre.pls.cv</a></code>,
 <code><a href="fregre.basis.cv.html">fregre.basis.cv</a></code>, <code><a href="optim.basis.html">optim.basis</a></code>, 
 <code>create.basis</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Eduardo Garcia-Portugues. Please, report bugs and suggestions to
 <a href="mailto:edgarcia@est-econ.uc3m.es">edgarcia@est-econ.uc3m.es</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulated example #</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">=</span><span class="fu"><a href="rproc2fdata.html">rproc2fdata</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>,t<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,l<span class="op">=</span><span class="fl">101</span><span class="op">)</span>,sigma<span class="op">=</span><span class="st">"OU"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta0</span><span class="op">=</span><span class="fu"><a href="fdata.html">fdata</a></span><span class="op">(</span>mdata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,l<span class="op">=</span><span class="fl">101</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,l<span class="op">=</span><span class="fl">101</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span></span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">101</span>,sd<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span>,argvals<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,l<span class="op">=</span><span class="fl">101</span><span class="op">)</span>,rangeval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span><span class="op">=</span><span class="fu"><a href="inprod.fdata.html">inprod.fdata</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">beta0</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,sd<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">21</span>,height<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">X</span>,main<span class="op">=</span><span class="st">"X"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">beta0</span>,main<span class="op">=</span><span class="st">"beta0"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>,main<span class="op">=</span><span class="st">"Density of Y"</span>,xlab<span class="op">=</span><span class="st">"Y"</span>,ylab<span class="op">=</span><span class="st">"Density"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Composite hypothesis: do not reject FLM</span></span></span>
<span class="r-in"><span><span class="va">pcvm.sim</span><span class="op">=</span><span class="fu">flm.test</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,B<span class="op">=</span><span class="fl">50</span>,B.plot<span class="op">=</span><span class="fl">50</span>,G<span class="op">=</span><span class="fl">100</span>,plot.it<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pcvm.sim</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,B<span class="op">=</span><span class="fl">5000</span><span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Estimated beta</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pcvm.sim</span><span class="op">$</span><span class="va">beta.est</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simple hypothesis: do not reject beta=beta0</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,beta0.fdata<span class="op">=</span><span class="va">beta0</span>,B<span class="op">=</span><span class="fl">50</span>,B.plot<span class="op">=</span><span class="fl">50</span>,G<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,beta0.fdata<span class="op">=</span><span class="va">beta0</span>,B<span class="op">=</span><span class="fl">5000</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># AEMET dataset #</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">aemet</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Remove the 5\</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res.FM</span><span class="op">=</span><span class="fu"><a href="depth.fdata.html">depth.FM</a></span><span class="op">(</span><span class="va">aemet</span><span class="op">$</span><span class="va">temp</span>,draw<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">qu</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">res.FM</span><span class="op">$</span><span class="va">dep</span>,prob<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">l</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">res.FM</span><span class="op">$</span><span class="va">dep</span><span class="op">&lt;=</span><span class="va">qu</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">aemet</span><span class="op">$</span><span class="va">temp</span><span class="op">[</span><span class="va">l</span><span class="op">]</span>,col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">aemet</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">name</span><span class="op">[</span><span class="va">l</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Data without outliers </span></span></span>
<span class="r-in"><span><span class="va">wind.speed</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">aemet</span><span class="op">$</span><span class="va">wind.speed</span><span class="op">$</span><span class="va">data</span>,<span class="fl">1</span>,<span class="va">mean</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="va">l</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">temp</span><span class="op">=</span><span class="va">aemet</span><span class="op">$</span><span class="va">temp</span><span class="op">[</span><span class="op">-</span><span class="va">l</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># Exploratory analysis: accept the FLM</span></span></span>
<span class="r-in"><span><span class="va">pcvm.aemet</span><span class="op">=</span><span class="fu">flm.test</span><span class="op">(</span><span class="va">temp</span>,<span class="va">wind.speed</span>,est.method<span class="op">=</span><span class="st">"pls"</span>,B<span class="op">=</span><span class="fl">100</span>,B.plot<span class="op">=</span><span class="fl">50</span>,G<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pcvm.aemet</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimated beta</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pcvm.aemet</span><span class="op">$</span><span class="va">beta.est</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># B=5000 for more precision on calibration of the test: also accept the FLM</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">temp</span>,<span class="va">wind.speed</span>,est.method<span class="op">=</span><span class="st">"pls"</span>,B<span class="op">=</span><span class="fl">5000</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simple hypothesis: rejection of beta0=0? Limiting p-value...</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">argvals</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">temp</span>,<span class="va">wind.speed</span>, beta0.fdata<span class="op">=</span><span class="fu"><a href="fdata.html">fdata</a></span><span class="op">(</span>mdata<span class="op">=</span><span class="va">dat</span>,argvals<span class="op">=</span><span class="va">temp</span><span class="op">$</span><span class="va">argvals</span>,</span></span>
<span class="r-in"><span>                                            rangeval<span class="op">=</span><span class="va">temp</span><span class="op">$</span><span class="va">rangeval</span><span class="op">)</span>,B<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">temp</span>,<span class="va">wind.speed</span>, beta0.fdata<span class="op">=</span><span class="fu"><a href="fdata.html">fdata</a></span><span class="op">(</span>mdata<span class="op">=</span><span class="va">dat</span>,argvals<span class="op">=</span><span class="va">temp</span><span class="op">$</span><span class="va">argvals</span>,</span></span>
<span class="r-in"><span>                                            rangeval<span class="op">=</span><span class="va">temp</span><span class="op">$</span><span class="va">rangeval</span><span class="op">)</span>,B<span class="op">=</span><span class="fl">5000</span><span class="op">)</span> </span></span>
<span class="r-in"><span>                                            </span></span>
<span class="r-in"><span><span class="co"># Tecator dataset #</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tecator</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">absorp</span><span class="op">=</span><span class="va">tecator</span><span class="op">$</span><span class="va">absorp.fdata</span></span></span>
<span class="r-in"><span><span class="va">ind</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">129</span> <span class="co"># or ind=1:215</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">=</span><span class="va">absorp</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">=</span><span class="va">tecator</span><span class="op">$</span><span class="va">y</span><span class="op">$</span><span class="va">Fat</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">tt</span><span class="op">=</span><span class="va">absorp</span><span class="op">[[</span><span class="st">"argvals"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Exploratory analysis for composite hypothesis with automatic choose of p</span></span></span>
<span class="r-in"><span><span class="va">pcvm.tecat</span><span class="op">=</span><span class="fu">flm.test</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,B<span class="op">=</span><span class="fl">100</span>,B.plot<span class="op">=</span><span class="fl">50</span>,G<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pcvm.tecat</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># B=5000 for more precision on calibration of the test: also reject the FLM</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,B<span class="op">=</span><span class="fl">5000</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Distribution of the PCvM statistic</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">pcvm.tecat</span><span class="op">$</span><span class="va">boot.statistics</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              main<span class="op">=</span><span class="st">"PCvM distribution"</span>, xlab<span class="op">=</span><span class="st">"PCvM*"</span>,ylab<span class="op">=</span><span class="st">"Density"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">pcvm.tecat</span><span class="op">$</span><span class="va">boot.statistics</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">pcvm.tecat</span><span class="op">$</span><span class="va">statistic</span>,col<span class="op">=</span><span class="fl">2</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"top"</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PCvM observed"</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simple hypothesis: fixed p</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">argvals</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,beta0.fdata<span class="op">=</span><span class="fu"><a href="fdata.html">fdata</a></span><span class="op">(</span>mdata<span class="op">=</span><span class="va">dat</span>,argvals<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">argvals</span>,</span></span>
<span class="r-in"><span>                               rangeval<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">rangeval</span><span class="op">)</span>,B<span class="op">=</span><span class="fl">100</span>,p<span class="op">=</span><span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-in"><span>                               </span></span>
<span class="r-in"><span><span class="co"># Simple hypothesis, automatic choose of p</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,beta0.fdata<span class="op">=</span><span class="fu"><a href="fdata.html">fdata</a></span><span class="op">(</span>mdata<span class="op">=</span><span class="va">dat</span>,argvals<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">argvals</span>,</span></span>
<span class="r-in"><span>                               rangeval<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">rangeval</span><span class="op">)</span>,B<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">flm.test</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,beta0.fdata<span class="op">=</span><span class="fu"><a href="fdata.html">fdata</a></span><span class="op">(</span>mdata<span class="op">=</span><span class="va">dat</span>,argvals<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">argvals</span>,</span></span>
<span class="r-in"><span>                               rangeval<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">rangeval</span><span class="op">)</span>,B<span class="op">=</span><span class="fl">5000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Manuel Febrero Bande, Manuel Oviedo de la Fuente.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

